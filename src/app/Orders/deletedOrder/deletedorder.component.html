<div class="container-fluid">
  <div class="logo2">
    <div class="card m-1">
      <h3
        class="card-header d-flex flex-column justify-content-center"
      >
      <span> <img src="../../../assets/imagesuiux/deleted_orders.png" style="width: 40px;height: 40px;">
        <b> Delete Orders (删除的订单)</b>
      </span>
      </h3>
      <div class="card-body" style="margin-top: -50px !important">
        <div class="filter">
          <form [formGroup]="deletedorderForm" (ngSubmit)="onSubmit()">
            <div class="row mobile-customer-project">
              <ngb-accordion
                #acc="ngbAccordion"
                [activeIds]="['panel1']"
                class="mobile2"
                style="padding-top: 14px"
              >
                <ngb-panel id="panel1">
                  <!-- <ng-template ngbPanelTitle>
                                    <span style="color:#0880ae;"><b>Filters</b></span>
                                </ng-template> -->
                  <ng-template ngbPanelContent>
                    <div class="card-body" style="padding: 0.5%">
                      <div class="row">
                        <div class="col-md-3">
                          <label class="form-label">Customer</label> <br />
                          <ng-select
                            formControlName="customer"
                            class="w-auto"
                            (change)="changecustomer($event)"
                          >
                            <ng-option
                              *ngFor="let sList of CustomerList"
                              [value]="sList.CustomerCode"
                            >
                              {{ sList.CustomerName }} ({{sList.CustomerCode}})
                            </ng-option>
                          </ng-select>
                        </div>

                        <div class="col-md-3">
                          <label class="form-label">Project</label> <br />
                          <ng-select
                            formControlName="project"
                            [(ngModel)]="SelectedProjectCodes"
                            [closeOnSelect]="false"
                            class="w-auto"
                            [multiple]="true"
                            (change)="changeproject($event)"
                            style="max-height: 65px; z-index: 5"
                          >
                            <ng-template
                              ng-header-tmp
                              *ngIf="ProjectList.length != 0"
                            >
                              <div
                                style="
                                  justify-content: space-between;
                                  display: flex;
                                "
                              >
                                <button
                                  class="btn btn-link"
                                  style="padding: 4px; border: 0px; margin: 0px"
                                  (click)="selectAllProject()"
                                >
                                  Select All
                                </button>
                                <button
                                  class="btn btn-link"
                                  style="padding: 4px; border: 0px; margin: 0px"
                                  (click)="clearAllProject()"
                                >
                                  Clear All
                                </button>
                              </div>
                            </ng-template>
                            <ng-option
                              *ngFor="let sList of ProjectList"
                              [value]="sList.ProjectCode"
                            >
                              {{ sList.ProjectTitle }}
                            </ng-option>
                          </ng-select>
                        </div>
                      </div>
                    </div>
                  </ng-template>
                </ngb-panel>
              </ngb-accordion>
            </div>
          </form>
          <div class="row logo2 customerandprojecthideonweb">
            <div _ngcontent-auh-c182="" class="col-md-7"><label _ngcontent-auh-c182="" class="form-label"></label><br _ngcontent-auh-c182=""><br><b _ngcontent-auh-c182="">Select All Project button to Include All Optional Projects (选择全部项目按钮至包括全部可选工程项目)</b>
            </div>
            <div class="col-md-4 float-right">
              <label class="form-label"></label> <br />
              <div
                class="input-group flex-nowrap"
                *ngIf="searchResult"
                style="padding-right: 30px"
              >
                <input
                  class="form-control"
                  type="search"
                  placeholder="Search "
                  value="search"
                  id="example-search-input"
                  name="search"
                  [(ngModel)]="searchText"
                  [ngModelOptions]="{ standalone: true }"
                />
                <span class="input-group-append ms-n5">
                  <span class="input-group-text">
                    <i class="bi bi-search"></i>
                  </span>
                </span>
              </div>
            </div>
            <div class="col-md-1">
              <label class="form-label"></label> <br />
              <div class="input-group flex-nowrap">
                <div class="mr-0 d-flex" style="margin-top: -6px">
                  <span class="btn input-group-text">
                    <i
                      class="material-icons"
                      style="font-size: 20px"
                      ngbTooltip="Download Excel"
                      (click)="ExportDeletedOrdersToExcel()"
                      >download</i
                    ></span>
                    <span class="btn input-group-text" (click)="editColumn = !editColumn"><i class="bi bi-gear-fill"
                        style="font-size: medium; z-index: 1" ngbTooltip="Edit Column" (mouseenter)="HoverSetting=true"
                        (mouseleave)="HoverSetting=false"></i></span>
                    </div>
                    </div>
            </div>
          </div><div class="setting-menu float-right logo2"
            [class.mat-elevation-z8]="true" *ngIf="editColumn" (mouseenter)="HoverSetting=true" (mouseleave)="HoverSetting=false">
            <div class="d-flex heading">
              <div class="d-flex" style="width: 50%; justify-content: space-between">
                <label class="fixed-xolumn-head">Fixed Columns: </label>
                <input class="form-control" type="number" max="7" min="0" [(ngModel)]="fixedColumn"
                  (change)="UpdateFixedColumns(fixedColumn)" />
              </div>
              <button type="button" class="btn-close" aria-label="Close" (click)="editColumn = false"></button>
            </div>
            <hr style="margin: 10px" />
            <div class="d-flex" style="
                                    justify-content: space-between;
                                    align-items: flex-end;
                                    padding-left: 5px;
                                  ">
              <span>Visible Columns</span>
            </div>
            <div class="d-flex">
             
              <table class="table table-bordered mobile2" style="height: fit-content" style="min-width: 0">
                <tbody>
                  <tr *ngFor="let headerColumn of splitArray(1,deletedColumns);">
                    <td>{{headerColumn.displayName}}</td>
                    <td><input type="checkbox" [(ngModel)]="headerColumn.isVisible" [checked]="headerColumn.isVisible"
                        (ngModelChange)="SaveColumnsSetting()"></td>
                  </tr>
                </tbody>
              </table>
              <table class="table table-bordered mobile2" style="height: fit-content" style="min-width: 0">
                <tbody>
                  <tr *ngFor="let headerColumn of splitArray(0,deletedColumns);">
                    <td>{{headerColumn.displayName}}</td>
                    <td><input type="checkbox" [(ngModel)]="headerColumn.isVisible" [checked]="headerColumn.isVisible"
                        (ngModelChange)="SaveColumnsSetting()"></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <div *ngIf="DeleteOrderLoading" style="z-index: 500">
            <div
              id="pause"
              class="d-flex align-items-center justify-content-center"
            >
              <div id="spinner" class="loader"></div>
            </div>
          </div>
          <div>
            <!-- <button class="btn btn-primary btn-sm" type="button" (click)="editColumn=!editColumn">
                        <i class="material-icons" style="font-size: medium;z-index: 1;"
                            ngbTooltip="Edit Column">mode_edit</i>&nbsp;</button> -->
            <div
              class="table-responsive table-wrapper-scroll-y my-custom-scrollbar logo3 order-table"
              style="max-height: 409px; height: 400px;"
            >
            <form [formGroup]="searchForm">
              <table class="table new-table">
                <thead
                  role="rowgroup"
                  id="DeleteOrderHeading"
                  [ngStyle]="{ position: 'sticky', top: '0px' }"
                >
                  <tr role="row" cdkDropList cdkDropListOrientation="horizontal" [cdkDropListData]="deletedColumns"
                  (cdkDropListDropped)="dropCol($event)">
                    <ng-container *ngFor="let headerColumn of deletedColumns;index as headIndex">
                      <th
                      #thNomVar
                      [style.cursor]="'pointer'"
                                           [style.left]="(headIndex+1) <= fixedColumn ? getRightWidthTest(thNomVar,headIndex) : 'inherit'"
                                           [style.display]="'table-cell'"
                                           [class.FixedColumn]="(headIndex+1) <= fixedColumn"
                      (click)="toggleSortingOrder(headerColumn.field,headerColumn.colName)"  *ngIf="headerColumn.isVisible" style="cursor: pointer;background-color: #003ec4b3; border-radius: 0px;" cdkDrag>
                        <div class="d-flex" style="
                            align-items: center;
                            justify-content: space-between;
                          " [style.max-width.px]="isMobile > 768 ? headerColumn.resizeWidth : 'auto'">
                          <span style="color: white; font-size: medium;"  [style.max-width.px]=" isMobile > 768 ? headerColumn.resizeWidth : 'auto'" > {{headerColumn.displayName}}<br />{{headerColumn.chineseDisplayName}}</span><i class="bi bi-arrow-up" *ngIf="
                              !isAscending && currentSortingColumn == headerColumn.field"></i><i class="bi bi-arrow-down" *ngIf="
                              isAscending && currentSortingColumn == headerColumn.field"></i>
                        </div>
                        <div [style.width.px]="headerColumn.resizeWidth" *ngIf="isMobile > 768"></div>
                      </th>
                    </ng-container>
                    <th *ngIf="showSelect" width='2%' style="color: white; font-size: medium;">Select<br />选择</th>
                    <th *ngIf="showDetails" width='3%' style="color: white; font-size: medium;">
                      Details<br />细节
                    </th>
                  </tr>
                </thead>
                <thead
                  id="searchBar"
                  *ngIf="toggleFilters"
                  [ngStyle]="{
                    position: 'sticky',
                    'top.px': getMinHeightIncoming('DeleteOrderHeading')
                  }"
                >
                  <tr>
                    <ng-container *ngFor="let searchColumn of deletedColumns;let j = index;">
                      <th
                      [style.left]="(j+1) <= fixedColumn ? searchColumn.left+'px !important' : 'inherit'"
                        [style.display]="'table-cell'"
                        [style.width]="isMobile > 768 ? searchColumn.width+ 'px' : 'auto'"
                        [class.FixedColumn]="(j+1) <= fixedColumn"
                      class="resize-column" style="text-align: center;background-color: white !important;" *ngIf="searchColumn.isVisible && searchColumn.controlName != 'dateRangeCreated' && searchColumn.controlName != 'dateRangeRequired'">
                        <input class="form-control" formControlName="{{searchColumn.controlName}}" [placeholder]="searchColumn.placeholder"/>
                        <div class="bar" appColumnResize [colName]="searchColumn.controlName" [colIndex]="j"
                    (widthChangeEvent)="onWidthChange($event)" cdkDrag></div>

                      </th>
                      <th  *ngIf="searchColumn.isVisible && (searchColumn.controlName == 'dateRangeCreated' || searchColumn.controlName == 'dateRangeRequired')" style="background-color: white !important;">
                        <app-bootsrtap-date-range-picker-for-search [clearInput]="clearInput" [controlName]="searchColumn.controlName" (dateRangeSelection)="onGetDateSelected($event)"></app-bootsrtap-date-range-picker-for-search>
                      </th>
                    </ng-container>

                    <th style="background-color: white !important;"></th>
                    <th style="background-color: white !important;">
                      <span style="margin: auto; padding: 2px">
                        <i
                          class="fa fa-refresh"
                          ngbTooltip="Reset"
                          style="color: red; font-size: 20px"
                          (click)="Reset_Filter()"
                        ></i>
                        &nbsp;
                        <label (click)="Reset_Filter()">Clear</label>
                      </span>
                    </th>
                  </tr>
                </thead>

                <tbody>
                  <tr class="no-record" *ngIf="deleteorderarray.length == 0" style="text-align: center">
                    <td colspan="13" style="text-align: center">
                      No Record Found
                    </td>
                  </tr>
                  <ng-container *ngFor="
                                      let item of deleteorderarray | filter : searchText;
                                      index as i
                                    ">
                    <tr [ngClass]="{'highlight': selectedRowIndex === i}"  [class.selected-draft-table]="item.rowSelected"
                      (click)="changeColor(i);">
                      <ng-container *ngFor="let showDataColumn of deletedColumns;index as searchIndex">
                        <td (click)="selectRow(item,deleteorderarray,$event)" [style.width]="isMobile > 768 ? showDataColumn.width+ 'px !important' : 'auto'"
                          [style.left]="(searchIndex+1) <= fixedColumn ? showDataColumn.left+'px !important' : 'inherit'"
                          [style.display]="'table-cell'"
                          [style.background-color]="(searchIndex+1) <= fixedColumn ? giveRowcolor(item): ''"
                          [class.FixedColumn]="(searchIndex+1) <= fixedColumn" *ngIf="showDataColumn.isVisible"> {{
                          item[showDataColumn.colName] }}</td>
                      </ng-container>
                      <!-- <td>{{ item.OrderNo }}</td>
                                      <td *ngIf="showWBS1">{{ item.WBS1 }}</td>
                                      <td *ngIf="showWBS2">{{ item.WBS2 }}</td>
                                      <td *ngIf="showWBS3">{{ item.WBS3 }}</td>
                                      <td *ngIf="showStructureElement">
                                        {{ item.StructureElement }}
                                      </td>
                                      <td *ngIf="showProductType">{{ item.ProdType }}</td>
                
                                      <td *ngIf="showPONo">{{ item.PONo }}</td>
                                      <td *ngIf="showCreateDate">{{ item.UpdateDate }}</td>
                                      <td *ngIf="showReqDate">{{ item.RequiredDate }}</td>
                                      <td *ngIf="showOrderWeight">{{ item.OrderWeight }}</td> -->
                
                      <td *ngIf="showSelect">
                        <!-- <input type="checkbox"> -->
                        <input type="checkbox" (click)="SelectAllChecked(item)" [checked]="item.isSelected" (change)="recordSelected(i)" />
                      </td>
                      <td *ngIf="showDetails">
                        <i class="bi bi-eye" ngbTooltip="View" (click)="ViewOrderDetails(item)" style="font-size:medium;"></i>&nbsp;
                        <!-- <i
                                          class="material-icons"
                                          (click)="Copy(item)"
                                          style="font-size: medium"
                                          ngbTooltip="Copy"
                                          >content_copy</i
                                        >
                                        &nbsp; -->
                      </td>
                    </tr>
                  </ng-container>
                </tbody>
              </table>
            </form>
            </div>


            <div class="row" style="justify-content: flex-end">
              <!-- <div class="col-md-9">
                                <div class="d-flex mt-2" style="flex-wrap:wrap">
                                    <ngb-pagination [collectionSize]="deleteorderarray.length" [(page)]="currentPage"
                                        [pageSize]="itemsPerPage" (pageChange)="onPageChange(currentPage); "
                                        [maxSize]="2" [boundaryLinks]="false" *ngIf="searchResult">
                                        <ng-template ngbPaginationPrevious>Prev</ng-template>
                                        <ng-template ngbPaginationNext>Next</ng-template>
                                    </ngb-pagination>

                                    <select class="custom-select mr-2 ml-3" style="width: auto"
                                        [(ngModel)]="itemsPerPage" (ngModelChange)="OnPageSizeChange(itemsPerPage);">
                                        <option [ngValue]="5">5 </option>
                                        <option [ngValue]="10">10 </option>
                                        <option [ngValue]="20">20 </option>
                                        <option [ngValue]="50">50 </option>
                                        <option [ngValue]="100">100 </option>
                                    </select>
                                    <span style="margin-top: 5px;">Items per page</span>

                                </div>
                            </div> -->
              <div
                class="col-md-3"
                style="display: flex; justify-content: flex-end"
               
              >
                <button
                  class="btn btn-primary btn-sm"
                  type="button"
                  style="width: 120px;"
                  (click)="Recover()"
                >
                  Recover
                </button>
              </div>
            </div>
            <div class="row">
              <div class="col md-6">
                <span style="font-weight: bold">
                  Total Deleted Orders :
                </span>
                <span style="font-weight: bold"> {{ deleteorderarray.length?deleteorderarray.length:0 }} </span>
              </div>
              <div class="col md-6 d-flex">
                <span style="font-weight: bold">
                  Notes: The deleted orders only keep for 7 days</span
                >
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
