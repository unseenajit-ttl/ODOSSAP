<!-- <h1 class="text-center">Order Assignment</h1>
  <div>
          <div *ngIf="!loading">
  <table class="table m-auto   d-table table-responsive   table-bordered table-hover" [cellPadding]="0" [cellPadding]="5">
    <thead>
      <tr>
       <th *ngFor="let headerColumn of headerColumn;">
                   {{headerColumn.displayName}}
                 
        </th>

      </tr>
    </thead>

    <tbody>

      <tr *ngFor="let item of schnellOrders | slice:pageSizeCommon:(pageSizeCommon + itemsPerPageCommon); index as i " (click)="onOrderClick(item)"
      style="cursor: pointer;" tabindex="0" (keydown)="onRowKeyDown($event, item)">
        <ng-container>
          <td>{{i+1}} </td>
          <td>{{item.OrderRequestNo}} </td>
          <td>{{item.OrderNo}} </td>
          <td>{{item.CustName}} </td>
          <td>{{item.ProjName}} </td>
          <td>{{item.proj_sub_segment}} </td>
          <td>{{item.Score}} </td>
          <td> 
            <span *ngIf="item.Score >= 85" style="color: green;font-size: 20px; font-weight: bold;">&#10004;</span> 
            <span *ngIf="item.Score < 85" style="color: red;font-size: 20px; font-weight: bold;">&#10006;</span>     
          </td>
          <td>
            <input type="checkbox" [(ngModel)]="item.isSelected" />
          </td>
        </ng-container>
      </tr>
    </tbody>
  </table>
</div>



<ngb-pagination [collectionSize]="schnellOrders.length" [pageSize]="itemsPerPageCommon" [(page)]="currentPageCommon"
  (pageChange)="onPageChangeCommon(currentPageCommon)" [boundaryLinks]="true" [maxSize]="maxSize">

  <ng-template ngbPaginationPrevious>Prev</ng-template>

  <ng-template ngbPaginationNext>Next</ng-template>

</ngb-pagination>

</div>
<div>
          <div *ngIf="showitem">
            <h2 style="text-align: left;margin-left: 3%;">Item Details</h2>
  <table class="table m-auto   d-table table-responsive   table-bordered " [cellPadding]="0" [cellPadding]="5">
    <thead>
      <tr>
        <th>ORDER_NO</th>
        <th>GRADE_DIA</th>
        <th>ITEM_NO</th>
        <th>SHAPE_CODE</th>
        <th>CAB_CUT_LENGTH</th>
        <th>PRODUCT_MARKING</th>
        <th>ORDER_QTY</th>
        <th>CAB_BVBS</th> 
      </tr>
    </thead>

    <tbody>

      <tr *ngFor="let item of  schnellOrderItems; index as i ">
        <ng-container>
          <td>{{selectedOrderNo}} </td>
          <td>{{item.grade_dia}} </td>
          <td>{{item.item_no}} </td>
          <td>{{item.shape_code}} </td>
          <td>{{item.cab_cut_length}} </td>
          <td>{{item.product_marking}} </td>
          <td>{{item.order_qty}} </td>
          <td>{{item.cab_bvbs}} </td>
        </ng-container>
      </tr>
    </tbody>
  </table>
</div>
</div> -->

<div class="container-fluid">
  <div class="logo2">

    <div class="card m-1">
      <h3 class="card-header d-flex flex-column justify-content-center">
        <span> <img src="../../../assets/imagesuiux/review.png" style="width: 40px;height: 40px;">
          <b> Order Assignment</b>
        </span>
      </h3>
      <div class="d-flex justify-content-start">
        <!-- <div class="p-2">
          <label class="required-label" style="padding-right:5px;">* </label>
          <label class="form-label"><b>Required Delivery Date From</b></label>
          <input type="date" class="form-control" 
            [(ngModel)]="FromReqDate"  name="fromReqDate">
        </div> -->
        <div class="col-md-2">
          <!-- <label class="required-label" style="padding-right:5px;">* </label> -->
          <label class="form-label"><b>Required Delivery Date From</b></label>
          <input type="date" class="form-control" [(ngModel)]="FromReqDate" >
        </div>
        <div class="col-md-2">
          <!-- <label class="required-label" style="padding-right:5px;">* </label> -->
          <label class="form-label"><b>Required Delivery Date To</b></label>
          <input type="date" class="form-control" [(ngModel)]="ToReqDate">

        </div>
        <div class="col-md-2">
          <!-- <label class="required-label" style="padding-right:5px;">* </label> -->
          <label class="form-label"><b>Customer</b></label>
                <ng-select [selectOnTab]="true" [(ngModel)]="selectedcustomer" class="w-auto"  (change)="OnCustomerChange()"
                placeholder="Customer">
                  <ng-option *ngIf="LoadingCustomerName">
                    <div style="justify-content: center;display: flex;">
                      <div class="spinner-border text-secondary" role="status">
                        <span class="sr-only">Loading...</span>
                      </div>
                    </div>
                  </ng-option>
                  <ng-option *ngFor="let sList of Customerlist" [value]="sList.CustomerCode">
                    {{sList.CustomerName}}
                  </ng-option>
                </ng-select>
        </div>
        <div class="col-md-2">
          <label class="form-label"><b>Project</b></label>
          <ng-select [selectOnTab]="true" [(ngModel)]="selectedproject" class="w-100"  placeholder="Project">
                  <ng-option *ngFor="let sList of projectList" [value]="sList.ProjectCode">
                    {{sList.ProjectTitle}}
                  </ng-option>
                </ng-select>
        </div>
        <div class="col-md-2" >
         
          <label class="form-label"><b>Product Type</b> </label>
          
            <ng-select class="w-auto" placeholder="Product Type" [(ngModel)]="selectedProductType" name="productType">
              <ng-option *ngFor="let sList of ProducttypeList" [value]="sList.name">
                {{sList.name}}
              </ng-option>
            </ng-select>
          

        </div>  
        <div class="col" style="flex: 0 0 12.5%;">
          <!-- <label class="required-label" style="padding-right:5px;">* </label> -->
          <label class="form-label"><b>Status</b> </label>
          <ng-select class="w-auto" placeholder="Status" [(ngModel)]="selectedstatus" name="status">
            <ng-option *ngFor="let sList of statusList" [value]="sList.name">
              {{sList.name}}
            </ng-option>
          </ng-select>

        </div>
        <div class="col-md-1">
          <label class="form-label"> </label>
          <div class="d-flex">
            <button class="btn btn-primary btn-sm" type="button" ngbTooltip="View Report" (click)="getSchnellOrderAssignment()">View
            </button>
          </div>
        </div>
      </div>
      <div class="card-body" style="margin-top: -47px !important;padding-bottom: 0%;padding-top: 1.5%;">
        <div class="filter">
          <form [formGroup]="activeorderForm" (ngSubmit)="onSubmit()" style="display: none;">
            <div class="row">
              <ngb-accordion #acc="ngbAccordion" [activeIds]="['panel1']" class="mobile2" style="padding-top: 14px">
                <ngb-panel id="panel1">
                  <!-- <ng-template ngbPanelTitle>
                                    <span style="color:#0880ae;"><b>Filters</b></span>
                                </ng-template> -->
                  <ng-template ngbPanelContent>
                    <div class="card-body" style="padding: 0.5%">
                      <div class="row float-right">


                        <!-- <div class="col-md-1" style="margin-top: 35px">
                                        <span style="margin-top: 35px">
                                          <i class="fa fa-refresh" ngbTooltip="Reset" style="color: #0479d6; font-size: 20px"
                                            (click)="onReset()"></i>
                                        </span>
                                      </div> -->
                        <div class="col-md-5">
                          <label class="form-label"></label> <br />
                          <div class="input-group flex-nowrap" *ngIf="searchResult" style="padding-right: 30px">
                            <input class="form-control" type="search" placeholder="Search (查找) " value="search"
                              id="example-search-input" name="search" [(ngModel)]="searchText"
                              [ngModelOptions]="{ standalone: true }"/>
                            <span class="input-group-append ms-n5">
                              <span class="input-group-text">
                                <i class="bi bi-search"></i>
                              </span>
                            </span>
                          </div>
                        </div>
                        <div class="col-md-1">
                          <label class="form-label"></label> <br />
                          <div class="input-group flex-nowrap">
                            <div class="mr-0" style="margin-top: -6px">
                              <span class="btn input-group-text">
                                <i class="material-icons" style="font-size: 20px" ngbTooltip="Export(导出)">download</i>
                              </span>
                            </div>
                          </div>
                        </div>
                        <!-- <div class="col">
                                                              <label class="form-label">Delivery Date</label> <br>
                                                              <do-date-picker  [formGroup]="activeorderForm" controlName="deliverydate" [class]="'form-control'">
                                                          </do-date-picker>
                                                          </div>
                                                          <div>
                                                              <label class="form-label">Delivery Date 2</label> <br>
                                                              <app-date-range-selector></app-date-range-selector>
                                                          </div> -->
                        <!-- <div class="colbutton ml-5" style="padding-top:20px">
                                                              <div class="d-flex">
                                                                  <br>
                                                                  <br>
                                                                  <button class="btn btn-primary btn-sm" type="submit">Search</button>
              
                                                                  <button class="btn btn-primary btn-sm" type="reset"
                                                                      (click)="onReset()">Reset</button>
              
                                                              </div>
                                                          </div> -->
                      </div>
                      <!-- <div class="row">
                                                          <div class="col">
                                                              <label class="form-label">Delivery Date</label> <br>
                                                              <do-date-picker  [formGroup]="deliveredorderForm" controlName="deliverydate"  [class]="'form-control'">
                                                          </do-date-picker>
                                                          </div>
                                                          <div class="col">
                                                              <label class="form-label">PO</label> <br>
              
                                                              <input type="text" formControlName="po" class="form-control" />
                                                          </div>
                                                          <div class="col">
                                                              <label class="form-label">PO Date</label> <br>
                                                              <do-date-picker  [formGroup]="deliveredorderForm" controlName="podate"  [class]="'form-control'">
                                                          </do-date-picker>
                                                          </div>
                                                          <div class="col">
                                                              <label class="form-label">DO</label> <br>
                                                              <input type="text" formControlName="requireddate"
                                                                  class="form-control" />
                                                          </div>
                                                          <div class="col">
                                                              <label class="form-label">WBS1 </label> <br>
                                                              <input type="text" formControlName="wbs1" class="form-control" />
                                                          </div>
                                                          <div class="col">
                                                              <label class="form-label">WBS2 </label> <br>
                                                              <input type="text" formControlName="wbs2" class="form-control" />
                                                          </div>
                                                          <div class="col">
                                                              <label class="form-label">WBS3 </label> <br>
                                                              <input type="text" formControlName="wbs3" class="form-control" />
                                                          </div>
                                                          <div class="col-3">
                                                              <label class="form-label">Include All Optional Project</label> <br>
                                                              <div class=" row custom-control custom-switch ml-2">
                                                                  <input type="checkbox" class="custom-control-input"
                                                                      formControlName="isinclude" id="isincludeSwitches"
                                                                      [checked]="false">
                                                                  <label class="custom-control-label" for="isincludeSwitches"></label>
                                                              </div>
                                                          </div>
              
                                                      </div> -->
                    </div>
                  </ng-template>
                </ngb-panel>
              </ngb-accordion>
            </div>
          </form>
          <div class="row logo2 customerandprojecthideonweb" style="padding: 0% ;margin-top: 1%;">
            <div _ngcontent-auh-c182="" class="col-md-6" style="font-size: medium;padding-right: 0px;"><br
                _ngcontent-auh-c182=""><br><b _ngcontent-auh-c182="">
                Order Header</b>
            </div>
            <div class="col-md-4 float-left" style="padding-left: 0px;padding-right: 0px;">
              <label class="form-label"></label> <br />
              <div class="input-group flex-nowrap" *ngIf="searchResult">
                <input class="form-control" type="search" placeholder="Search (查找)" value="search"
                  id="example-search-input" name="search" [(ngModel)]="searchText"
                  [ngModelOptions]="{ standalone: true }" (ngModelChange)="onSearchChange()" />
                <span class="input-group-append ms-n5">
                  <span class="input-group-text">
                    <i class="bi bi-search" (click)="onSearchClick()"></i>
                  </span>
                </span>
              </div>
            </div>
            <div class="col-md-1">
              <label class="form-label"></label> <br />
              <div class="input-group flex-nowrap">
                <div class="mr-0 pd-0 d-flex" style="margin-top: -6px">
                  <span class="btn input-group-text">
                    <i class="material-icons" style="font-size: 20px" ngbTooltip="Export   (导出)" (click)="ExportToExcel()">download</i>
                    <!-- ?<i class="material-icons" style="font-size: 20px" ngbTooltip="Export   (导出)">download</i> -->
                  </span>&nbsp;&nbsp;
                  <span class="btn input-group-text" (click)="editColumn = !editColumn" (mouseenter)="HoverSetting=true"
                    (mouseleave)="HoverSetting=false">
                    <i class="bi bi-gear-fill" style="font-size: medium; z-index: 1"
                      ngbTooltip="Edit Column"></i></span>
                </div>
              </div>
            </div>
          </div>
          <div class="setting-menu float-right logo2" [class.mat-elevation-z8]="true" *ngIf="editColumn"
            (mouseenter)="HoverSetting=true" (mouseleave)="HoverSetting=false">
            <div class="d-flex heading">
              <div class="d-flex" style="width: 50%; justify-content: space-between">
                <label class="fixed-xolumn-head">Fixed Columns: </label>
                <input class="form-control" type="number" max="7" min="0" [(ngModel)]="fixedColumn"
                  (change)="UpdateFixedColumns(fixedColumn)" />
              </div>
              <button type="button" class="btn-close" aria-label="Close" (click)="editColumn = false"></button>
            </div>
            <hr style="margin: 10px;border-top: 1px solid #101112;" />
            <div class="d-flex" style="
                                    justify-content: space-between;
                                    align-items: flex-end;
                                    padding-left: 5px;
                                  ">
              <span>Visible Colums</span>
            </div>
            <div class="d-flex">

              <table class="table table-bordered mobile2" style="height: fit-content" style="min-width: 0">
                <tbody>
                  <tr *ngFor="let headerColumn of splitArray(1,OrdAssgnColumns);">
                    <td>{{headerColumn.displayName}}</td>
                    <td><input type="checkbox" [(ngModel)]="headerColumn.isVisible" [checked]="headerColumn.isVisible"
                        (ngModelChange)="SaveColumnsSetting()">
                    </td>
                  </tr>
                </tbody>
              </table>
              <table class="table table-bordered mobile2" style="height: fit-content" style="min-width: 0">
                <tbody>
                  <tr *ngFor="let headerColumn of splitArray(0,OrdAssgnColumns);">
                    <td>{{headerColumn.displayName}}</td>
                    <td><input type="checkbox" [(ngModel)]="headerColumn.isVisible" [checked]="headerColumn.isVisible"
                        (ngModelChange)="SaveColumnsSetting()">
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          <!-- <div  style="z-index: 500">
            <div id="pause" class="d-flex align-items-center justify-content-center">
              <div id="spinner" class="loader"></div>
            </div>
          </div> -->
          <div *ngIf="!loading" style="z-index: 500">
            <div id="pause" class="d-flex align-items-center justify-content-center">
              <div id="spinner" class="loader"></div>
            </div>
          </div>
          <div>
            <div class="table-responsive table-wrapper-scroll-y my-custom-scrollbar order-table" *ngIf="loading">
              <cdk-virtual-scroll-viewport itemSize="100" #scrollViewportENT (scroll)="syncScroll($event)"
                style="height: 53vh;">
                <form [formGroup]="searchForm">
                  <table class="table new-table">
                    <thead [style.top]="inverseOfENT" id="DraftOrderHeading"
                      [ngStyle]="{'position':'sticky','top': '0px'}">

                      <tr [style.top]="inverseOfENT" cdkDropList cdkDropListOrientation="horizontal"
                        [cdkDropListData]="OrdAssgnColumns" (cdkDropListDropped)="dropCol($event)">

                        <ng-container *ngFor="let headerColumn of OrdAssgnColumns;index as headIndex;">
                          <th #thNomVar [style.top]="inverseOfENT"
                            (click)="toggleSortingOrder(headerColumn.field,headerColumn.colName)"
                            [style.cursor]="'pointer'"
                            [style.left]="(headIndex+1) <= fixedColumn ? getRightWidthTest(thNomVar,headIndex) : 'inherit'"
                            [style.display]="'table-cell'" [class.FixedColumn]="(headIndex+1) <= fixedColumn"
                            *ngIf="headerColumn.isVisible"
                            style="cursor: pointer; background-color: #003ec4b3; border-radius: 0px;
                            white-space: normal; word-wrap: break-word;" cdkDrag>
                            <div [style.width.px]="headerColumn.resizeWidth" role="columnheader">
                              <div class="d-flex" [style.width.px]="headerColumn.resizeWidth" style="
                                                    align-items: center;
                                                    justify-content: space-between; 
                                                  ">
                                <span style="color: white; font-size: medium;white-space: normal; word-break: break-word;"
                                  [style.width.px]="headerColumn.resizeWidth">
                                  {{headerColumn.displayName}}<br />{{headerColumn.chineseDisplayName}}</span>
                                <i class="bi bi-arrow-up" style="color: white; font-weight: 900; font-size: 1.2rem; text-shadow: 0 0 1px white;"
                                  *ngIf="
                                                      !isAscending && currentSortingColumn == headerColumn.field"></i><i
                                  class="bi bi-arrow-down"  style="color: white; font-weight: 900; font-size: 1.2rem; text-shadow: 0 0 1px white;"
                                   *ngIf="
                                                      isAscending && currentSortingColumn == headerColumn.field"></i>
                              </div>
                            </div>
                            <div [style.width.px]="headerColumn.resizeWidth"></div>

                          </th>
                        </ng-container>

                        <th width='4%' [style.top]="inverseOfENT" *ngIf="loading"
                          style="color: white; font-size: medium;border-radius: 0px;">Suggestions</th>
                        <!-- <th width='4%' [style.top]="inverseOfENT" *ngIf="loading"
                          style="color: white; font-size: medium;border-radius: 0px;">Action<br />选择</th> -->
                        <th width='4%' [style.top]="inverseOfENT" *ngIf="loading"
                          style="color: white; font-size: medium;border-radius: 0px;">Extra Cab_cut_length<br />选择</th>
                        <th width='4%' [style.top]="inverseOfENT" *ngIf="loading"
                          style="color: white; font-size: medium;border-radius: 0px;">
                          Planner Confirmation
                        </th>
                        <!-- commented-->
                        <th width='4%' [style.top]="inverseOfENT" *ngIf="loading"
                          style="color: white; font-size: medium;border-radius: 0px;">
                          Withdrawal Confirmation
                        </th>
                      </tr>
                    </thead>
                    <!-- <thead id="searchBar" *ngIf="toggleFilters" [style.top]="inverseOfENTSearch"
                    [ngStyle]="{'position':'sticky','top.px': getMinHeightIncoming('DraftOrderHeading')}">
                    <tr [style.top]="inverseOfENTSearch">
                      <ng-container *ngFor="let searchColumn of OrdAssgnColumns;let j = index;">
                        <th [style.top]="inverseOfENTSearch" class="resize-column" style="text-align: center;background-color: white !important;"
                          [style.width]="searchColumn.width+ 'px !important'"
                          [style.left]="(j+1) <= fixedColumn ? searchColumn.left+'px !important' : 'inherit'"
                          [style.display]="'table-cell'" [class.FixedColumn]="(j+1) <= fixedColumn"
                          *ngIf="searchColumn.isVisible && searchColumn.controlName != 'RequiredDate' && searchColumn.controlName != 'UpdateDate'">
                          <input class="form-control" formControlName="{{searchColumn.controlName}}" />
                          <div class="bar" appColumnResize 
                            (widthChangeEvent)="onWidthChange($event)" cdkDrag></div>
                        </th>
                        <th [style.top]="inverseOfENTSearch" class="resize-column" style="text-align: center; background-color: white !important;"
                          *ngIf="searchColumn.isVisible && (searchColumn.controlName == 'RequiredDate' || searchColumn.controlName == 'UpdateDate')">
                          <app-bootsrtap-date-range-picker-for-search [clearInput]="clearInput"
                            [controlName]="searchColumn.controlName"   (dateRangeSelection)="onGetDateSelected($event)">
                          </app-bootsrtap-date-range-picker-for-search>
                        </th>
                      </ng-container>
                      <th [style.top]="inverseOfENTSearch" style="background-color: white !important;"></th>
                      <th [style.top]="inverseOfENTSearch" style="background-color: white !important;">
                        <span style="margin: auto; padding: 2px">
                          <i class="fa fa-refresh" ngbTooltip="Reset" style="color: red; font-size: 20px"
                            (click)="Reset_Filter()"></i>&nbsp;
                          <label (click)="Reset_Filter()">Clear</label>
                        </span>
                      </th>
                    </tr>
                  </thead> -->
                    <tbody>
                      <tr class="no-record" *ngIf="schnellOrders.length == 0">
                        <td colspan="16" style="text-align: center">
                          No Record Found
                        </td>
                      </tr>
                      <ng-container *ngFor="
                      let item of schnellOrders | filter : searchText;
                      index as i;">

                        <!-- <tr *ngIf="DraftOrderLoading">
                                        <td colspan="5">
                                            <div style="justify-content: center;display: flex;">
                                                <div class="spinner-border text-secondary" role="status">
                                                    <span class="sr-only">Loading...</span>
                                                </div>

                                            </div>

                                        </td>
                                    </tr> -->
                        <tr class="draft-table"
                        [class.row-focused]="selectedRowIndex === i"
                        [class.shared-draft-table]="item.OrderShared"
                        (click)="onOrderClick(item)"
                        (keydown)="onRowKeyDown($event, i)"
                        [attr.tabindex]="selectedRowIndex === i ? '0' : '-1'"
                        [attr.aria-selected]="selectedRowIndex === i"
                        style="cursor: pointer;"
                        [attr.data-index]="i" [ngClass]="{ 'highlight-row': item.OrderNo === selectedOrderNo }">
                          <ng-container *ngFor="let showDataColumn of OrdAssgnColumns;index as searchIndex;">
                            <td [style.width]="showDataColumn.width+ 'px !important'"
                              [style.left]="(searchIndex+1) <= fixedColumn ? showDataColumn.left+'px !important' : 'inherit'"
                              [style.display]="'table-cell'" [class.FixedColumn]="(searchIndex+1) <= fixedColumn"
                              *ngIf="showDataColumn.isVisible" [title]="item[showDataColumn.colName]"> {{
                              item[showDataColumn.colName]}}</td>
                          </ng-container>
                          <td style="text-align: center;">
                            <span *ngIf="item.Score >= 85"
                              style="color: green;font-size: 20px; font-weight: bold;">&#10004;</span>
                            <span *ngIf="item.Score < 85"
                              style="color: red;font-size: 20px; font-weight: bold;">&#10006;</span>
                          </td>
                            <td class="text-center">

                           
                            <ng-container *ngIf="!item.isEditing && item.Extra_cab_cut_length <= 0; else editMode">
                              <i class="material-icons"
                                 style="color: grey; cursor: pointer;"
                                 ngbTooltip="Edit"
                                 (click)="onEdit(i)" [ngClass]="{ 'disabled-icon': item.CouplrBrPeices <= 0 || item.AssignmentStatus === 'ASSIGNED' }"
                                 [style.pointer-events]="item.CouplrBrPeices <= 0 || item.AssignmentStatus === 'ASSIGNED' ? 'none' : 'auto'">
                                 mode_edit
                              </i>
                            </ng-container>
                          
                            
                            <ng-template #editMode>
                              <div *ngIf="item.isEditing || item.Extra_cab_cut_length > 0" class="d-flex align-items-center justify-content-center">
                                <i class="material-icons"
                                   style="color: grey; cursor: pointer;"
                                   ngbTooltip="Edit Done" >
                                   mode_edit
                                </i>
                                <input type="number"
                                       [(ngModel)]="item.Extra_cab_cut_length"
                                       [ngModelOptions]="{ standalone: true }"
                                       class="form-control me-2"
                                       style="max-width: 100px; font-size: 16px; font-weight: bold; font-family: Arial, sans-serif;"
                                       min="1"
                                       step="1"
                                       (keydown)="blockInvalid($event)"
                                       [disabled]="item.AssignmentStatus === 'ASSIGNED'"> 
                              </div>
                            </ng-template>
                          
                          </td>
                          <td style="text-align: center;" (click)="toggleCheckbox(item)">
                            <input type="checkbox" [(ngModel)]="item.isSelected"  [ngModelOptions]="{ standalone: true }"  style="position: relative; z-index: 10; " 
                             [disabled]="item.AssignmentStatus === 'ASSIGNED' || item.AssignmentStatus === 'CANCEL'" (click)="$event.stopPropagation()">
                          </td>
                          <td style="text-align: center;"  (click)="toggleCheckboxwithdrawal(item)">
                            <input type="checkbox" [(ngModel)]="item.isWithdrawal"  [ngModelOptions]="{ standalone: true }"  style="position: relative; z-index: 10; " 
                             [disabled]="item.AssignmentStatus === 'NOT ASSIGNED' || item.AssignmentStatus === 'CANCEL'" (click)="$event.stopPropagation()">
                          </td>
                        </tr>
                      </ng-container>
                    </tbody>
                  </table>
                </form>
              </cdk-virtual-scroll-viewport>
            </div>
            <!-- <ngb-pagination [collectionSize]="schnellOrders.length" [pageSize]="itemsPerPageCommon"
              [(page)]="currentPageCommon" (pageChange)="onPageChangeCommon(currentPageCommon)" [boundaryLinks]="true"
              [maxSize]="maxSize">

              <ng-template ngbPaginationPrevious>Prev</ng-template>

              <ng-template ngbPaginationNext>Next</ng-template>

            </ngb-pagination> -->
            <div class="row">
              <div class="col-md-12 d-flex align-items-center justify-content-between">
                <div class="d-flex align-items-center gap-2" style="font-weight:bold;">
                <label>Assign To</label>
                <ng-select name="proj_prod" id="proj_prod" [multiple]="true" [(ngModel)]="SelectedCategory">
                  <ng-option *ngFor="let prod of CategoryList" [value]="prod">{{prod}}</ng-option>
                </ng-select>
                <button class="btn btn-primary btn-sm" style="width: 80px;" type="button" (click)="Export()">
                  Export
                </button>
                <button class="btn btn-primary btn-sm" style="width: 80px;" type="button" (click)="Withdraw()">
                  Withdraw
                </button>
              </div>
              <div style="margin-right: 3%;">
                <label class="btn btn-primary btn-sm m-0 d-flex align-items-center" style="cursor: pointer;">
                  <input type="checkbox"
                         [(ngModel)]="allSelected"
                         (change)="SelectAllExport()"
                         style="margin-right: 5px;" />
                  Select All
                </label>
              </div>
            </div>
          </div>
          <div class="row logo2 customerandprojecthideonweb" style="padding: 0% ">
            <div class="col-md-7" style="font-size: medium;padding-top: 0.5%;padding-bottom: 0.5%;" *ngIf="showitem"><b
                _ngcontent-auh-c182="">
                Order Details</b>
            </div>
            <br>
            <div class="table-responsive table-wrapper-scroll-y my-custom-scrollbar order-table" *ngIf="showitem">
              <cdk-virtual-scroll-viewport itemSize="20" #scrollViewportENT (scroll)="syncScroll($event)"
                style="height: 35vh;">

                <table class="table my-auto-width-table" style="min-width: max-content;">
                  <thead [style.top]="inverseOfENT" id="DraftOrderHeading"
                    [ngStyle]="{'position':'sticky','top': '0px'}">

                    <tr [style.top]="inverseOfENT" cdkDropList cdkDropListOrientation="horizontal">
                      <th [style.top]="inverseOfENT" style="color: white; font-size: medium;border-radius: 0px;">Order
                        No</th>
                      <th [style.top]="inverseOfENT" style="color: white; font-size: medium;border-radius: 0px;">Item No
                      </th>
                      <th [style.top]="inverseOfENT" style="color: white; font-size: medium;border-radius: 0px;">Shape
                        Code</th>
                      <th [style.top]="inverseOfENT" style="color: white; font-size: medium;border-radius: 0px;">Total
                        Weight</th>
                      <th [style.top]="inverseOfENT" style="color: white; font-size: medium;border-radius: 0px;">No. of
                        Cuts</th>
                      <th [style.top]="inverseOfENT" style="color: white; font-size: medium;border-radius: 0px;">No. of
                        Bendings</th>
                      <th [style.top]="inverseOfENT" style="color: white; font-size: medium;border-radius: 0px;">No. of
                        Pieces</th>
                      <th [style.top]="inverseOfENT" style="color: white; font-size: medium;border-radius: 0px;">
                        M-Run</th>
                      <th [style.top]="inverseOfENT"
                        style="color: white; font-size: medium;border-radius: 0px;white-space: nowrap; padding: 8px;">
                        Score</th>
                      <th [style.top]="inverseOfENT" style="color: white; font-size: medium;border-radius: 0px;">Sum of
                        Weight</th>
                      <th [style.top]="inverseOfENT" style="color: white; font-size: medium;border-radius: 0px;">Default
                        Route</th>
                      <!-- <th [style.top]="inverseOfENT" style="color: white; font-size: medium;border-radius: 0px;">Product
                        Type</th> -->
                      <th [style.top]="inverseOfENT" style="color: white; font-size: medium;border-radius: 0px;">Diameter</th>
                      <th [style.top]="inverseOfENT" style="color: white; font-size: medium;border-radius: 0px;">
                        Cab_cut_length</th>
                      <th [style.top]="inverseOfENT"
                        style="color: white; font-size: medium;border-radius: 0px;white-space: nowrap; padding: 8px;">
                        Product Marking</th>
                      <th [style.top]="inverseOfENT" style="color: white; font-size: medium;border-radius: 0px;">Cab
                        bvbs</th>
                    </tr>
                  </thead>

                  <tbody>

                    <tr *ngFor="let item of  schnellOrderItems; index as i ">
                      <ng-container>
                        <td style="width:5%;">{{selectedOrderNo}} </td>
                        <td style="width:3%;">{{item.item_no}} </td>
                        <td style="width:4%;">{{item.shape_code}} </td>
                        <td style="width:5%;">{{item.TotalWeight}} </td>
                        <td style="width:4%;">{{item.NoofCuts}} </td>
                        <td style="width:5%;">{{item.NoofBends}} </td>
                        <td style="width:5%;">{{item.NoofPieces}} </td>
                        <td style="width:3%;">{{item.MRun}} </td>
                        <td style="width:3%;">{{item.Score}} </td>
                        <td style="width:5%;">{{item.SumofWeight}} </td>
                        <td style="width:5%;">{{item.DefaultRoute}} </td>
                        <!-- <td style="width:5%;">{{item.ProductType}} </td> -->
                        <td style="width:4%;">{{item.cab_dia}} </td>
                        <td style="width:5%;">{{item.cab_cut_length}} </td>
                        <td style="width:6%;">{{item.product_marking}} </td>
                        <td style="width:15%;" [title]="item.cab_bvbs">{{item.cab_bvbs}} </td>
                      </ng-container>
                    </tr>
                  </tbody>
                </table>
              </cdk-virtual-scroll-viewport>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>